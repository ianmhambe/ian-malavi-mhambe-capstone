# Sealed Secrets Configuration for CareSync
# This file contains instructions and templates for using Bitnami Sealed Secrets
# to securely manage database credentials and other sensitive data

# Prerequisites:
# 1. Install Sealed Secrets Controller in the cluster:
#    kubectl apply -f https://github.com/bitnami-labs/sealed-secrets/releases/download/v0.24.5/controller.yaml
#
# 2. Install kubeseal CLI:
#    brew install kubeseal  # macOS
#    # or download from https://github.com/bitnami-labs/sealed-secrets/releases

# Step 1: Create a regular secret (DO NOT commit this to git)
# Save this as 'secret-template.yaml' locally:
#
# apiVersion: v1
# kind: Secret
# metadata:
#   name: caresync-secrets
#   namespace: ian-malavi-mhambe
# type: Opaque
# stringData:
#   DATABASE_URL: "mysql://USERNAME:PASSWORD@YOUR_RDS_ENDPOINT:3306/YOUR_DATABASE"
#   JWT_SECRET: "your-jwt-secret-here"
#   JWT_REFRESH_SECRET: "your-jwt-refresh-secret-here"

# Step 2: Seal the secret using kubeseal:
# kubeseal --format yaml < secret-template.yaml > sealed-secret.yaml

# Step 3: Apply the sealed secret (safe to commit to git)
# kubectl apply -f sealed-secret.yaml

---
# Template for SealedSecret resource (example structure)
# Note: The 'encryptedData' values below are placeholders
# You must generate real sealed secrets using kubeseal
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: caresync-secrets
  namespace: ian-malavi-mhambe
  labels:
    app.kubernetes.io/name: caresync
    app.kubernetes.io/component: secrets
spec:
  encryptedData:
    # These are placeholder values - replace with actual sealed values
    # Generate using: echo -n "value" | kubeseal --raw --namespace ian-malavi-mhambe --name caresync-secrets
    DATABASE_URL: AgBZ3M4K5e7Hj9kL2nP1qR4sT6uW8xY0zA... # PLACEHOLDER - generate with kubeseal
    JWT_SECRET: AgCX2N3O5p6Q7r8S9t0U1v2W3x4Y5z6A7b... # PLACEHOLDER - generate with kubeseal
    JWT_REFRESH_SECRET: AgDY4P5Q6r7S8t9U0v1W2x3Y4z5A6b7C8... # PLACEHOLDER - generate with kubeseal
  template:
    metadata:
      name: caresync-secrets
      namespace: ian-malavi-mhambe
      labels:
        app.kubernetes.io/name: caresync
        app.kubernetes.io/component: secrets
    type: Opaque
